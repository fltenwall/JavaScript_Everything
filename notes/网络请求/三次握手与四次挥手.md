
#### 建立TCP 连接

1. 先建立网络连接，确保双方都有收发消息的能力 ---- TCP
2. 传输内容 ---- HTTP

#### 为什么需要三次握手，两次不行吗？

这是由 TCP 的自身特点可靠传输决定的。客户端和服务端要进行可靠传输，那么就需要确认双方的接收和发送能力。

第一次握手，客户端->服务端，可以确认客户端的发送能力，将 SYN 发送给服务端

第二次握手，服务端->客户端，确认了服务端的发送能力和接收能力，将 SYN+ACK发送给客户端，表示接收到消息

第三次握手，客户端->服务端，将 ACK 返回，才可以确认客户端的接收能力。不然容易出现丢包的现象。

#### 为什么需要四次挥手，三次不行吗？

断开连接时，需要发送四次报文

四次挥手是保证客户端没有数据传输了

第一次是客户端->服务端，告知服务端请求结束，但是数据可能还在进行

第二次是服务端->客户端，服务端告知收到客户端请求，但数据可能仍在传输

第三次是服务端->客户端，数据发送完毕，服务端发送消息到客户端通知客户端数据发送完毕

第四次是客户端->服务端，客户端发送消息通知服务端数据接收完毕，服务端可以断开

#### 能将第二次和第三次合并成一次吗？

1. 如果将第二次和第三次合并，服务端发送数据时间可能较长，客户端长时间无法接收消息，会导致客户端重发请求
2. 第二次只是通知客户端接收到了客户端关闭请求，但是数据可能仍未结束，提前返回请求响应客户端